# GenClime - модуль для прогноза климата

## Описание

Здесь весь backend модуля GenClimate, обернутый в приложение на FastAPI и запускающийся в Docker.
Модуль предназначен для получения прогнозов на некоторое количество дней вперед. Пользователь может посмотреть прогноз по какому-либо городу или по каким-лиюо координатам (широте и долготе) на 15 дней по одной из моделей, а также выбрать определенный регион (в примерах - Япония), получить визуализацию прогноза на сетке по каждому из параметров или скачать прогноз в формате `.zarr`.

## Как это все работает

![Архитектура](imgs/backend_scheme.svg)

Есть модель предсказатель - `Diviner`. Это docker-файл, который запускается раз в сутки с помощью планировщика `cron`. Обновляет прогнозы и падает. 

Сейчас по API можно получить самые свежие прогнозы. Сейчас примеры прогнозов на 15 дней можно получить по ссылке.

### Point forecast

Это первый endpoint. Что это такое: пользователь вводит в форму либо город, по которому хочет получить прогноз, либо координаты. Потом он вводит `days` - число дней, за которые он хочет получить прогноз. А также параметр `params` - по каким параметрам пользователь хочет получить прогноз.

У `params` есть три опции: 

| Опция       | Параметры                                                                       |
| ----------- | ------------------------------------------------------------------------------- |
| **simple**  | `2t`, `10u`, `10v`, `msl`                                                       |
| **surface** | `10u`, `10v`, `2d`, `2t`, `msl`, `skt`, `sp`, `tcw`, `lsm`, `z`, `slor`, `sdor` |
| **full**    | *(все доступные переменные)*                                                    |

**Примечания**:

* `2t` — температура воздуха на 2 м
* `10u`, `10v` — компоненты ветра на 10 м
* `msl` — давление на уровне моря
*  и тд.

Пример запроса по API

```bash
curl "http://127.0.0.1:8003/v1/point_forecast?city=Moscow&days=3&params=surface&mode=base&model=medium"
```

или

> (с точки зрения API - равнозначные запросы)

```bash
curl "http://127.0.0.1:8003/v1/point_forecast?city=lat=55.62&lon=37.606&days=3&params=surface&mode=base&model=medium"
```
Ответ - в формате `.json`. Пример лежит в папке [`example`](./example), в файле [`example`](./example/out_point.json)




